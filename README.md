# Project_1
README for HW

# Задание: 
# VM1 – установить веб-сервер Apache, интерпретатор PHP. Выбрать режим взаимодействия Apache и PHP, выбор обосновать.
# VM2 – установить сервис баз данных MySQL. Настроить взаимодействие с VM1 (Настроить «двух-узловой» стек LAMP)
# Установить на полученном стенде LAMP в качестве веб-сайта CMS WordPress.
# Добавить в организованный на VM1, VM2 стек LAMP второй вебсайт. Используйте CMS на ваш выбор, но не WordPress. Произвести все необходимые изменения в настройках веб- cервера. Сервис баз данных для второго вебсайта использовать также удаленный, с VM2.

# В результате, оба вебсайта должны открываться с вашего компьютера в браузере по имени, но без использования внешнего DNS сервера. (Используем способ задания приоритетных DNS-записей, применяемый при локальной разработке).
# Написать инструкцию по настройке в формате «Howto», как все настраивали (обоснования выбора режимов взаимодействия здесь), и добавить в отчет. «Howto» пишем в формате «инструкции будущему себе», если бы вам пришлось повторить данную процедуру через год, при этом ни разу не выполняя подобные задачи на его протяжении.

---------------------------------------------------------------------------------------------------------------------------------------------------------------------

# Установить 2 VM, настроить статические IP-адреса, чтобы VM работали в одной сети и проверить ping.

# Установка и настройка Apache на VM1 через apt
  sudo apt update
  sudo apt install apache2

# После завершения установки сервер Apache должен быть запущен автоматически. Проверить его статус командой
  sudo systemctl status apache2

# Установить фаервол
  sudo apt install ufw

# Включить фаервол UFW
  sudo ufw enable

# Проверить статус фаервола
  sudo ufw status

# Добавить правило, чтобы входящие запросы были разрешены извне для порта 80
  sudo ufw allow 80

# Проверить работу Apache
# Веб-сервер Apache должен быть доступен по адресу http://localhost в браузере. Должна отобразиться страница приветствия Apache, если все установлено и работает верно.

---------------------------------------------------------------------------------------------

# Установить интерпретатор php
  sudo apt update
  sudo apt install php7.4 libapache2-mod-php7.4 php-common php7.4 php7.4-cli php7.4-common php7.4-json php7.4-opcache php7.4-readline

# Проверка модуля в Apache
  sudo apachectl -M                              # д.быть php7_module
  sudo a2enmod php7.4                            # добавление модуля, если его нет
  sudo a2dismod php7.4                           # disable

# Перезапуск Apache после внесения изменений
  sudo systemctl restart apache2

# Проверить работу PHP
# В директории /var/www/html создать файл и прописать код 
  sudo nano /var/www/html/info.php
  <?php phpinfo(); ?>
# В браузере в адресной строке ввести http://localhost/info.php
# В результате должны увидеть страницу с подробной информацией о конфигурации PHP.

-----------------------------------------------------------------------------------------------------------------------------------------------------------------

# На VM2 установить MySQL/MariaDB
  sudo apt update
  sudo apt install mariadb-server

# Настройка MariaDB
  sudo mysql_secure_installation

# Сделать MariaDB доступной для всех адресов
  sudo nano /etc/mysql/mariadb.conf.d/50-server.cnf 
# Строку bind-address = 127.0.0.1 закомментировать, а ниже добавить
  bind-address = 0.0.0.0

# Сохранить измения и перезапустить сервис
  sudo service mariadb restart

# Создать 2 БД
  sudo mysql -u root -p

  CREATE DATABASE wordpress;
  CREATE USER 'wordpressuser'@'%' IDENTIFIED BY 'password';
  GRANT ALL PRIVILEGES ON wordpress.* TO 'wordpressuser'@'%';
  FLUSH PRIVILEGES;

  CREATE DATABASE joomla;
  CREATE USER 'joomlauser'@'%' IDENTIFIED BY 'password';
  GRANT ALL PRIVILEGES ON joomla.* TO 'joomlauser'@'%';
  FLUSH PRIVILEGES;
  EXIT;
  
------------------------------------------------------------------------------------------------------------------------------------------------------------------



